<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
	<script src="https://kit.fontawesome.com/2889a448a0.js" crossorigin="anonymous"></script>
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

	<style>
		body, html {
			font-family: helvetica;
			font-size: 18px;
			line-height: 1.2;
		}
		a {
			color: black;
		}
		a:hover {
			color: lightgrey;
			text-decoration: none;
		}
		.code {
			font-family: monospace;
			font-size: 14px;
			background-color: #f1f1f1;
			border-radius: 5px;
			padding: 5px;
			padding-left: 15px;
			width: 100%;
		}
		.display-none {
			display: none;
		}
		.bdr {
			border-top: solid 1px black;
		}
		.ellipsis {
			white-space: nowrap;
 			overflow: hidden;
 			text-overflow: ellipsis;
		}
		.list {
			font-size: 58px;
			line-height: 1;
		}
		.responsive {
			display: block;
		}
		.responsive-invert {
			display: none;
		}
		.table-padding {
			padding: 0;
			padding-top: 10px;
			padding-bottom: 10px;
		}
		@media (max-width: 1006px) {
			.table-padding {
				padding: 0;
				padding-top: 25px;
				padding-bottom: 25px;
			}
			.responsive {
				display: none;
			}
			.responsive-invert {
				display: block;
			}
			.list {
				font-size: 48px;
				line-height: 1;
				text-decoration: underline;
			}
		}
	</style>

    <title>Github resume</title>
</head>
	<body>
		<div id="loading" class="fixed-bottom container h-100">
		  <div class="row h-100 justify-content-center align-items-center">
		    <div class="col-12 text-center">
				<div class="spinner-border" role="status">
	  				<span class="sr-only">Loading...</span>
				</div>
		  	</div>
		  </div>
		</div>

		<div id="content" class="container-fluid p-0 display-none">

			<div class="p-3">
			<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
				 viewBox="0 0 1383.2 213.4" style="enable-background:new 0 0 1383.2 213.4;" xml:space="preserve">
			<g>
				<path d="M37.1,4.9l64.3,171.4L166,4.9h37.1v204h-25.7V39.1h-0.6l-63.7,169.7H90L26.3,39.1h-0.6v169.7H0V4.9H37.1z"/>
				<path d="M371.5,33.7c-10.4-7.2-22.7-10.9-37-10.9c-12.2,0-22.6,2.3-31.3,6.9c-8.7,4.6-15.8,10.7-21.4,18.4
					c-5.6,7.7-9.8,16.5-12.4,26.4c-2.7,9.9-4,20.2-4,30.9c0,11.6,1.3,22.6,4,33c2.7,10.4,6.8,19.4,12.4,27.1
					c5.6,7.7,12.8,13.9,21.6,18.4c8.8,4.6,19.2,6.9,31.4,6.9c8.9,0,16.9-1.5,23.9-4.4c6.9-3,12.9-7,18-12.3c5-5.2,9-11.5,11.9-18.7
					c2.9-7.2,4.6-15,5.1-23.4h27.1c-2.7,25.7-11.5,45.7-26.6,60c-15,14.3-35.6,21.4-61.7,21.4c-15.8,0-29.6-2.7-41.4-8.1
					c-11.8-5.4-21.6-12.9-29.4-22.4c-7.8-9.5-13.7-20.8-17.6-33.7c-3.9-12.9-5.9-26.9-5.9-41.7s2.1-28.8,6.3-41.8
					c4.2-13,10.3-24.4,18.4-34.1c8.1-9.7,18.2-17.4,30.3-23C305.3,2.8,319.2,0,334.8,0c10.7,0,20.8,1.4,30.3,4.3
					c9.5,2.9,18,7,25.4,12.6c7.4,5.5,13.6,12.4,18.6,20.7c5,8.3,8.2,17.9,9.7,28.7h-27.1C388.6,51.8,381.9,40.9,371.5,33.7z"/>
				<path d="M539.9,4.9l79.7,204h-30l-22.3-61.4h-86.3l-22.9,61.4h-27.7l79.4-204H539.9z M558.8,124.5l-34-95.1h-0.6l-34.6,95.1H558.8z
					"/>
				<path d="M713.6,4.9c4.4,0,9.1,0,14.1,0.1c5,0.1,10,0.4,15,0.9c5,0.5,9.6,1.2,13.9,2.1c4.3,1,7.9,2.4,11,4.3c6.7,4,12.3,9.5,17,16.6
					c4.7,7,7,15.7,7,26c0,10.9-2.6,20.2-7.9,28.1c-5.2,7.9-12.7,13.8-22.4,17.6v0.6c12.6,2.7,22.2,8.4,28.9,17.1c6.7,8.8,10,19.4,10,32
					c0,7.4-1.3,14.7-4,21.7c-2.7,7-6.6,13.3-11.9,18.7c-5.2,5.4-11.7,9.8-19.4,13.1c-7.7,3.3-16.6,5-26.7,5h-98.6V4.9H713.6z M721,92.6
					c15.4,0,26.5-2.7,33.3-8.1C761,79,764.4,70.8,764.4,60c0-7.2-1.1-12.9-3.4-17.1c-2.3-4.2-5.4-7.4-9.4-9.7c-4-2.3-8.6-3.8-13.9-4.4
					c-5.2-0.7-10.8-1-16.7-1h-54.3v64.8H721z M734.7,186c12,0,21.4-3.2,28.1-9.7c6.8-6.5,10.1-15.4,10.1-26.9c0-6.7-1.2-12.2-3.7-16.6
					c-2.5-4.4-5.8-7.9-9.9-10.4c-4.1-2.6-8.8-4.4-14.1-5.4c-5.3-1-10.9-1.6-16.6-1.6h-62V186H734.7z"/>
				<path d="M931.3,4.9c19.4,0,34.6,4.8,45.6,14.3c10.9,9.5,16.4,22.6,16.4,39.1c0,12.4-2.8,23.2-8.4,32.6c-5.6,9.3-14.6,15.7-27,19.1
					v0.6c5.9,1.1,10.7,3,14.4,5.7c3.7,2.7,6.7,5.9,8.9,9.6c2.2,3.7,3.8,7.9,4.9,12.4c1,4.6,1.9,9.3,2.4,14.3c0.4,5,0.7,10,0.9,15.1
					c0.2,5.1,0.7,10.2,1.4,15.1c0.8,5,1.9,9.7,3.3,14.1c1.4,4.5,3.6,8.4,6.4,11.9h-30.3c-1.9-2.1-3.2-5-3.9-8.6
					c-0.7-3.6-1.1-7.7-1.3-12.1c-0.2-4.5-0.4-9.3-0.6-14.4c-0.2-5.1-0.8-10.2-1.7-15.1c-0.8-4.9-1.7-9.7-2.9-14.1
					c-1.1-4.5-3-8.4-5.4-11.7c-2.5-3.3-5.7-6-9.7-8c-4-2-9.3-3-16-3h-66.3v87.1h-27.1V4.9H931.3z M937,97.4c5.7-1,10.7-2.8,15-5.6
					c4.3-2.8,7.7-6.5,10.3-11.1c2.6-4.7,3.9-10.7,3.9-18.1c0-10.3-2.9-18.7-8.6-25.1c-5.7-6.5-15-9.7-27.7-9.7h-67.4v71.1H919
					C925.3,98.8,931.3,98.4,937,97.4z"/>
				<path d="M1025.7,66.7c4.1-12.9,10.2-24.2,18.4-34.1c8.2-9.9,18.4-17.8,30.6-23.7C1086.8,3,1101,0,1117.2,0c16.2,0,30.4,3,42.6,8.9
					c12.2,5.9,22.4,13.8,30.6,23.7c8.2,9.9,14.3,21.3,18.4,34.1c4.1,12.9,6.1,26.2,6.1,40.1c0,13.9-2,27.3-6.1,40.1
					c-4.1,12.9-10.2,24.2-18.4,34.1c-8.2,9.9-18.4,17.8-30.6,23.6c-12.2,5.8-26.4,8.7-42.6,8.7c-16.2,0-30.4-2.9-42.6-8.7
					c-12.2-5.8-22.4-13.7-30.6-23.6c-8.2-9.9-14.3-21.3-18.4-34.1c-4.1-12.9-6.1-26.2-6.1-40.1C1019.5,92.9,1021.6,79.6,1025.7,66.7z
					 M1050.7,137.3c2.7,10,6.9,19,12.6,27c5.7,8,13,14.4,22,19.3c9,4.9,19.6,7.3,32,7.3c12.4,0,23-2.4,32-7.3
					c8.9-4.9,16.3-11.3,22-19.3c5.7-8,9.9-17,12.6-27c2.7-10,4-20.1,4-30.4c0-10.3-1.3-20.4-4-30.4c-2.7-10-6.9-19-12.6-27
					c-5.7-8-13-14.4-22-19.3c-9-4.9-19.6-7.3-32-7.3c-12.4,0-23,2.4-32,7.3c-9,4.9-16.3,11.3-22,19.3c-5.7,8-9.9,17-12.6,27
					c-2.7,10-4,20.1-4,30.4C1046.7,117.1,1048,127.3,1050.7,137.3z"/>
				<path d="M1275.2,4.9V186h108v22.9h-135.1V4.9H1275.2z"/>
			</g>
			</svg>
			</div>
			<div class="row p-0 pl-3 pr-3 pt-1 m-0">
				<div class="col-2 m-0 p-0 responsive">
					<a href="#"><p class="m-0">Martin Cabrol</p></a>
				</div>
				<div class="col-2 m-0 p-0 responsive">
					<a href="#"><p class="m-0">Project</p></a>
				</div>
				<div class="col-2 m-0 p-0 responsive">
					<a href="#"><p class="m-0">Info</p></a>
				</div>
				<div class="col-2 m-0 p-0 responsive">
					<a href="#"><p class="m-0">Contact</p></a>
				</div>
			</div>

			<div class="p-0 pl-3 pr-3 pt-1 m-0 responsive-invert">
				<a href="#"><p class="m-0 p-0">Martin Cabrol<i class="fas fa-bars float-right"></i></p></a>
			</div>

			<div id="table" class="p-0 pl-3 pr-3 pt-1">

			</div>

			<!-- <div class="p-3">
				<input id="search" type="text" placeholder="Login"/>
				<button type="button" onclick="search_api()">ok</button>
			</div> -->

			<p class="m-0 p-0 pb-2 pl-3 pr-3">Console</p>
			<div class="row p-3 m-0">
				<div id="console" class="code p-4"></div>
			</div>
			<!-- <p class="m-0 p-0 pb-2 pl-3 pr-3">Raw code</p>
			<div class="row p-3 m-0">
				<div id="raw" class="code p-4"></div>
			</div> -->


		</div>


		<script type="text/javascript">

		function pad(number) {
     		return (number < 10 ? '0' : '') + number
		}

		function output(input, element) {
			element.append(function() {
  				return "<p>" + input + "</p>";
			});
		}

		function display_loading(index) {
			var loading = $('#loading');
			var content = $('#content');
			if (index == 0) {
				content.css("display", "none");
			} else {
				loading.css("display", "none");
				content.css("display", "block");
			}
		}

		function print(value) {
			$("#console").append(function() {
				return ("<p>" + value['name'] + " / " + value['created_at'] + " / " + value['description'] + " / " + value['language'] + " / " + value['license'] + "</p>");
			});
		}

		function parse_contributors(data) {
			var obj = JSON.parse(data);
			var size = Object.keys(obj).length;

			if (size > 1) {
				console.log(size - 1 + " contributors");
			} else {
				console.log("No contributors");
			}
		}

		function parse_contents(data) {
			var obj = JSON.parse(data);
			var size = Object.keys(obj).length;
			var readme = 0;
			console.log(size + " files:")
			obj.forEach(function (value, i) {
				output(i + " " + value['name'], $("#console"));
				if (value["name"].localeCompare("README.md") == 0) {
					readme = i;
					console.log("obj[" + (readme + 1) + "] = " + obj[readme].name);
				}
				else {
					i = -1;
				}
			});
			if (readme) {
				request_readme(obj[readme].download_url);
			}
		}

		function parse_readme(data) {
			output("README.md: " + data, $("#console"));
		}

		function parse_commits(data) {
			var obj = JSON.parse(data);
			var size = Object.keys(obj).length;
			output(size - 1 + " commits", $("#console"));
		}

		function parse(data) {
			var obj = JSON.parse(data);

			if (obj["message"] && obj["message"].localeCompare("Not found")) {
				output("Not found", $("#console"));
			} else {
				obj.forEach(print);
				obj.forEach(function (value, i) {
					$("#table").append(function() {
						let str;
						// List
						str = '<a onclick="display_detail(\'' + value['name'] +  '\')">';
							str += '<div class="list bdr row m-0 p-0">';
								str += '<div class="col-sm-2 m-0 table-padding">';
									str += '<p class="m-0 p-0">';
										str += pad(i + 1);
									str += '</p>';
								str += '</div>';
								str += '<div class="col-sm-2 table-padding m-0 responsive">';
									str += '<p class="m-0">';
										str += value['created_at'].substr(0, 4);
									str += '</p>';
								str += '</div>';
								str += '<div class="col-sm-5 table-padding m-0">';
									str += '<p class="m-0 p-0">';
										str += value['name'];
									str += '</p>';
								str += '</div>';
							str += '</div>';
						str += '</a>';

						// Detail

						str += '<div class="bdr row m-0 p-0 display-none">';
						str += '<div class="col-sm-4 m-0 table-padding">';
						str += '<p class=m-0>Last update:</p>';
						str += '<p>';
						str += value['updated_at'].substr(0, 10);
						str += '</p>';
						str += '</div>';
						str += '<div class="col-sm-4 m-0 table-padding">';
						str += '<p>';
						str += value['description'];
						str += '</p>';
						str += '<p>';
						str += value['description'];
						str += '</p></div></div>';
						return (str);
					});
				});

				// // Raw code
				// var str = JSON.stringify(data, undefined, 4);
				// output(str, $("#raw"));
			}
		}

		function search_api() {
			var x = $("#search").val();
			request_profile(x);
		}

		function display_detail(x) {
			output("####### Details: " + x, $("#console"));
			request_contributors(x);
			request_commits(x);
			request_contents(x);
		}

		function request_profile(username)
		{
			const xhr = new XMLHttpRequest();
			const url = `https://api.github.com/users/${username}/repos`;
			xhr.open('GET', url, true);
			xhr.onload = function() {
				display_loading(0);
				parse(this.response);
				display_loading(1);
			}
			xhr.send();
		}

		function request_readme(raw_url)
		{
			const xhr = new XMLHttpRequest();
			const url = `${raw_url}`;
			xhr.open('GET', url, true);
			xhr.onload = function() {
				display_loading(0);
				parse_readme(this.response);
				display_loading(1);
			}
			xhr.send();
		}

		function request_contributors(project)
		{
			const xhr = new XMLHttpRequest();
			const url = `https://api.github.com/repos/mcabrol/${project}/contributors`;
			xhr.open('GET', url, true);
			xhr.onload = function() {
				display_loading(0);
				parse_contributors(this.response);
				display_loading(1);
			}
			xhr.send();
		}

		function request_commits(project)
		{
			const xhr = new XMLHttpRequest();
			const url = `https://api.github.com/repos/mcabrol/${project}/commits`;
			xhr.open('GET', url, true);
			xhr.onload = function() {
				display_loading(0);
				parse_commits(this.response);
				display_loading(1);
			}
			xhr.send();
		}

		function request_contents(project)
		{
			const xhr = new XMLHttpRequest();
			const url = `https://api.github.com/repos/mcabrol/${project}/contents`;
			xhr.open('GET', url, true);
			xhr.onload = function() {
				display_loading(0);
				parse_contents(this.response);
				display_loading(1);
			}
			xhr.send();
		}

		$( document ).ready(function() {
    		console.log( "ready!" );
			request_profile("tjuzen");
		});





		</script>
	</body>
</html>
